# Unity 学习笔记

## 2D

[官方2D路线图](https://unity.com/cn/roadmap/unity-platform/2d)

## 教程

* [官方教程] [Ruby's Adventure：2D 初学者](https://learn.unity.com/project/ruby-s-adventure-2d-chu-xue-zhe)

  项目 ● 初学者 ● 14 小时 20 分钟 ● 知识点 29 ● 类型 RPG
  
  ★ 当前阅读进度
  [视觉风格 - 用户界面 - 抬头显示 - 7.什么是锚点？](https://learn.unity.com/tutorial/shi-jue-feng-ge-yong-hu-jie-mian-tai-tou-xian-shi?uv=2020.3&projectId=5facf921edbc2a2003a58d3a#6073e01bedbc2a0021c5b736)
  [精灵动画 - 1.Animator](https://learn.unity.com/tutorial/jing-ling-dong-hua?uv=2020.3&projectId=5facf921edbc2a2003a58d3a#6073def7edbc2a04020b22a0)

  ---

* [官方教程] [创作者套件：RPG](https://learn.unity.com/project/chuang-zuo-zhe-tao-jian-rpg?uv=2020.3)

  项目 ● 初学者 ● 1 小时 10 分钟 ● 知识点 14 ● 类型 RPG

  ★ 当前阅读进度
  [填充你的事解 - 4.添加 NPC 对话](https://learn.unity.com/tutorial/tian-chong-ni-de-shi-jie?uv=2020.3&projectId=5facfb7dedbc2a001f53383c#6073f4b4edbc2a001f576ac6)

  ---

* [官方教程] [平台游戏 Microgame](https://learn.unity.com/project/ping-tai-you-xi-microgame?uv=2019.3)

  模板项目 ● 知识点 9 ● 类型 横版

  此 Microgame 模板是你可以修改和自定义的经典 2D 平台游戏。在学习 Unity 基础知识的同时，请了解创意修改 (Creative Mods)，这样你就可以调整已有项目并添加你自己的关卡。正在从 Unity Hub 的 Learn 选项卡中查看项目？单击 Download Project > Open Project 即可在 Unity 中自动打开项目。正在从 Unity Learn 网站中查看项目？只需转到 Unity Hub 中的 Learn 选项卡，然后搜索此 Microgame，或通过下面的 Asset Store 链接手动将其导入。

  ★ 当前阅读进度
  [2D 平台游戏修改：有色世界 - 深入学习](https://learn.unity.com/tutorial/2d-ping-tai-you-xi-xiu-gai-you-se-shi-jie?uv=2019.3&projectId=5facf6bcedbc2a043f509bd7#)

---

## Packages

* Cinemachine

  [Cinemachine](https://learn.unity.com/tutorial/cinemachine#)

  [摄像机 - Cinemachine](https://learn.unity.com/tutorial/she-xiang-ji-cinemachine?projectId=5facf921edbc2a2003a58d3a#)

---

## Resources

* 官方资源包
  * [Premium 2D Characters](https://assetstore.unity.com/packages/2d/characters/premium-2d-characters-98327)

* 其他资源包
  * [ScriptableObject的介绍](https://blog.csdn.net/bianchengxiaosheng/article/details/78226014)
  * [itch.io](https://itch.io/)
  * [itch.io](https://legnops.itch.io/red-hood-character/download/eyJleHBpcmVzIjoxNjM2MzQwOTM3LCJpZCI6NzkxODcyfQ%3d%3d.QveUATLDv7cc11RMQ5ysxX%2b2Ukk%3d)
  * [冒险酒吧的故事 - 成套2d素材(国外)](https://www.aigei.com/view/26191.html)
  * [恐龙王 - 成套2d素材(国外)-地图可参考](https://www.aigei.com/view/30959.html?page=2)
  * [Arcadias 战斗公主 - 成套2d素材(国外)](https://www.aigei.com/view/46094.html)
  * [Nekketsu Kakutō Densetsu-成套2d素材(国外)](https://www.aigei.com/view/50898.html)
  * [市中心的 Nekketsu 物语 - 成套2d素材(国外)](https://www.aigei.com/view/49877.html)
  * [大骑士历史 - 成套2d素材(国外)](https://www.aigei.com/view/36688-21952585.html)
  * [跨越边缘 - 成套2d素材(国外)](https://www.aigei.com/view/46124.html)
  * [恶魔猎人传奇 - 成套2d素材(国外)](https://www.aigei.com/view/27141.html)
  * [洛克人 X4 - 成套2d素材(国外)](https://www.aigei.com/view/53756.html)
  * [最终幻想 : 勇敢 Exvius - 成套2d素材(国外)-整套格斗动作](https://www.aigei.com/view/27574.html?page=10)
  * [城堡的冲突 - 成套2d素材(国外)](https://www.aigei.com/view/26715.html?page=2)
  * [命运 / 无限的代码 - 成套2d素材(国外)](https://www.aigei.com/view/45833.html)
  * [资源包网站](http://www.zyb99.cn/241)
  * [像素小人制作工具（付费）](https://booth.pm/zh-cn/items/2490778)
  * [indienova 独立游戏](https://indienova.com/sp/gameDevResource)
  * [像素画高级教程：8方向游戏角色](https://32comic.com/2020/08/13/%e5%83%8f%e7%b4%a0%e7%94%bb%e9%ab%98%e7%ba%a7%e6%95%99%e7%a8%8b%ef%bc%9a8%e6%96%b9%e5%90%91%e6%b8%b8%e6%88%8f%e8%a7%92%e8%89%b2/)
  * [百度贴吧 - 最经典的十款 FC 红白机 RPG 游戏](http://tieba.baidu.com/p/6841888066)
  * [Unity Documentation](https://docs.unity3d.com/cn/2019.4/Manual/UnityWebRequest.html)
  * [使用 Visual Studio Code 创建 .NET 控制台应用程序](https://docs.microsoft.com/zh-cn/dotnet/core/tutorials/with-visual-studio-code?WT.mc_id=dotnet-35129-website)
  * [Unity 3D C# 脚本基础](http://c.biancheng.net/view/2678.html)
  * [在Unity中实现TCP通信（附完整工程）](https://blog.csdn.net/qq_39748832/article/details/108540564)

---

## Manual

* [UnityWebRequest](https://docs.unity3d.com/cn/2020.3/Manual/UnityWebRequest.html)
* [瓦片地图渲染器 (Tilemap Renderer)](https://docs.unity3d.com/cn/2020.3/Manual/class-TilemapRenderer.html)

---

## 哔哩哔哩

* [【游戏开发】Unity 2D 角色控制逻辑教程（移动，翻滚，瞬移）](https://www.bilibili.com/video/av94823619/)
* [M_Studio - 3DRPG核心教程每周五晚6:30更新！各平台请看公告](https://space.bilibili.com/370283072/)
* [谜样神君 - RPG Marker](https://space.bilibili.com/2394867)
* [哔哩哔哩 搜索 tile地图](https://search.bilibili.com/all?keyword=tile%20地图)

---

## 动画笔记
1. Animator 组件
2. Animator Controller
3. 通过 Animation 窗口创建 Animation Clip
4. 通过 Animator 窗口编辑 Animator Controller

---

## 解决抖动的根本原因
移动`刚体`本身而不是游戏对象`transform`

---

## Unity Scripts

角色控制脚本，记录以强化记忆

```
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PlayerController : MonoBehaviour
{
    public float speed = 3.0f;

    public float timeInvincible = 2.0f;
    float invincibleTimer;
    bool isInvincible;

    public int maxHP = 5;
    public int HP { get { return currentHP; }}
    int currentHP;

    Rigidbody2D rigidbody2d;
    float horizontal;
    float vertical;

    Animator animator;
    Vector2 direction = new Vector2(1, 0);
    


    // Start is called before the first frame update
    void Start()
    {
        // 更改每秒渲染帧数
        // QualitySettings.vSyncCount = 0;
        // Application.targetFrameRate = 36;
        
        rigidbody2d = GetComponent<Rigidbody2D>();

        animator = GetComponent<Animator>();

        currentHP = maxHP;
    }

    // Update is called once per frame
    void Update()
    {
        horizontal = Input.GetAxis("Horizontal");
        vertical = Input.GetAxis("Vertical");

        // Vector2 position = transform.position;
        // position.x = position.x + speed * horizontal * Time.deltaTime;
        // position.y = position.y + speed * vertical * Time.deltaTime;
        // transform.position = position;

        if (isInvincible)
        {
            invincibleTimer -= Time.deltaTime;
            if (invincibleTimer < 0) isInvincible = false;
        }

        Vector2 move = new Vector2(horizontal, vertical);
        if(!Mathf.Approximately(move.x, 0.0f) || !Mathf.Approximately(move.y, 0.0f))
        {
            direction.Set(move.x, move.y);
            direction.Normalize();
        }
        
        animator.SetFloat("Move X", direction.x);
        animator.SetFloat("Move Y", direction.y);
        animator.SetFloat("Speed", move.magnitude);

        // animator.SetFloat("Move X", horizontal);
        // animator.SetFloat("Move Y", vertical);
    }
    
    // Unity 还有另一个名为 FixedUpdate 的函数，只要你想直接影响物理组件或对象（例如刚体），就需要使用该函数。
    // FixedUpdate 不会持续运行
    void FixedUpdate()
    {
        Vector2 position = rigidbody2d.position;
        position.x = position.x + speed * horizontal * Time.deltaTime;
        position.y = position.y + speed * vertical * Time.deltaTime;

        rigidbody2d.MovePosition(position);
    }

    public void ChangeHP(int amount)
    {
        if (amount < 0) {
            if (isInvincible) return;
            isInvincible = true;
            invincibleTimer = timeInvincible;
        }
        currentHP = Mathf.Clamp(currentHP + amount, 0, maxHP);
        Debug.Log(currentHP);
    }
}

```

早期留存脚本
```
using System.Collections;
using System.Collections.Generic;
using System.IO;
using UnityEngine;
using UnityEngine.Networking;

public class script : MonoBehaviour
{
  public GameObject myCube;
  public int transSpeed = 100;
  public float rotaSpeed = 10.5f;
  public float scale = 3;

  void OnGUI()
  {
    if(GUILayout.Button("移动立方体")){
      myCube.transform.Translate(Vector3.forward * transSpeed * Time.deltaTime, Space.World);
    }
    if(GUILayout.Button("旋转立方体")){
      myCube.transform.Rotate(Vector3.up * rotaSpeed, Space.World);
    }
    if(GUILayout.Button("缩放立方体")){
      myCube.transform.localScale = new Vector3(scale, scale, scale);
    }
  }

  // Start is called before the first frame update
  void Start()
  {
    // 协程
    // https://blog.csdn.net/qq_15020543/article/details/82701551

    // 网络地址
    string uri = "http://localhost:7001";

    // 本地地址
    // var uri = new System.Uri(Path.Combine(Application.streamingAssetsPath, "data.json"));

    // AssetBundles Url
    // string uri = "file:///" + Application.dataPath + "/AssetBundles/" + assetBundleName;

    StartCoroutine(HttpRequest(uri));

    // 上传文件
    
  }

  /***
   * 网络请求
   * 支持 GET，POST，PUT（上传） 方法
   */
  IEnumerator HttpRequest(string uri, byte[] data = null, string method = "get")
  {
    UnityWebRequest www;
    
    // 上传
    if (method == "put")
    {
      byte[] myData = System.Text.Encoding.UTF8.GetBytes("This is some test data");
      www = UnityWebRequest.Put(uri, myData);
    }
    else if (method == "post")
    {
      // 转 formData
      List<IMultipartFormSection> myData = new List<IMultipartFormSection>();
      myData.Add(new MultipartFormDataSection("field1=foo&field2=bar"));
      myData.Add(new MultipartFormFileSection("my file data", "myfile.txt"));

      www = UnityWebRequest.Post(uri, myData);
    }
    else
    {
      // uri 最后是图片后缀(png)
      // UnityWebRequest www = UnityWebRequestTexture.GetTexture(uri);

      // uri 最后是音频后缀(ogg)
      // UnityWebRequest www = UnityWebRequestMultimedia.GetAudioClip(uri, AudioType.OGGVORBIS);

      // uri 最后是Assetbundle(.unity3d)
      // UnityWebRequest www = UnityWebRequestAssetBundle.GetAssetBundle(uri, 0);

      // 网络请求
      www = UnityWebRequest.Get(uri);

      // 本地请求
      // UnityWebRequest www = UnityWebRequest.Get(uri.AbsoluteUri);
    }
    
    // 设置报头
    // www.SetRequestHeader("Content-Type", "application/json");

    yield return www.SendWebRequest();

    // Debug.Log("status code:" + www.responseCode);
    // Debug.Log(www.isHttpError);
    
    // if (www.isHttpError)
    // if (www.result != UnityWebRequest.Result.Success)
    if (www.result == UnityWebRequest.Result.ConnectionError)
    {
      Debug.Log(www.error);
    }
    else
    {
      string text = www.downloadHandler.text;           // 文本信息，使用UTF8编码解析
      byte[] bytes = www.downloadHandler.data;          // 字节数组

      Debug.Log(text);
      Debug.Log(bytes);
      
      // uri 最后是图片后缀
      // Texture myTexture = DownloadHandlerTexture.GetContent(www);
      
      // uri 最后是音频后缀(ogg)
      // var audio = DownloadHandlerAudioClip.GetContent(www);

      // uri 最后是Assetbundle(.unity3d)
      // AssetBundle bundle = DownloadHandlerAssetBundle.GetContent(request);
      // GameObject cube = bundle.LoadAsset<GameObject>("Cube");
      // GameObject sprite = bundle.LoadAsset<GameObject>("Sprite");
      // Instantiate(cube);
      // Instantiate(sprite);

      // Method Post
      // Debug.Log("Form upload complete!");

      // Method Upload
      // Debug.Log("Upload complete!");
    }
  }

  IEnumerator UploadTexture()
  {
    var tex = new Texture2D(1,1);
    tex.ReadPixels(new Rect(0, 0, Screen.width, Screen.height), 0, 0);
    tex.Apply();
    // tex.Apply() 对性能影响较大，故等待一帧再执行
    yield return null;
    var bytes = tex.EncodeToPNG();
    var form = new WWWForm();
    form.AddBinaryData("screenshot", bytes);
    var www = UnityWebRequest.Post("server url", form);
    yield return www.SendWebRequest();
    // ...
  }


  // 获取本地文件
  IEnumerator RequestFile()
  {
    var uri = new System.Uri(Path.Combine(Application.streamingAssetsPath, "data.json"));
    var request = UnityWebRequest.Get(uri.AbsoluteUri);
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.ConnectionError) {
      Debug.Log(request.error);
    } else {
        Debug.Log(request.downloadHandler.text);
    }
  }
}

```

---

## Mac下.git文件夹不显示的问题
Mac 下 .git 文件夹不显示主要是由于隐藏文件/文件夹没有显示，就和 win 的隐藏文件一样。
在命令行中运行以下命令即可实现显示 `隐藏文件/夹`:
```
defaults write com.apple.finder.AppleShowAllFiles TRUE
killall Finder
```
如果重新把 `隐藏文件/夹` 隐藏起来，则只需把上面第一条命令中的 `TRUE` 改为 `FALSE`，然后重新运行两条命令即可。

---

## Cocos Creator 3.x海量资源资源，手把手教学
```
https://mp.weixin.qq.com/s?__biz=MjM5MTc1MjM2Ng==&mid=2247484247&idx=1&sn=c8a7be1cfaca21468548d3957f8b60bf&chksm=a6b18a9691c603806e24c1ecabfaae7b48269a5eb7ca9f8edd73aad39dd9e14c13d817760cff&mpshare=1&scene=23&srcid=1108fzbVjcozvQDvLVHcAfS8&sharer_sharetime=1636331914631&sharer_shareid=ae144912df1071bc517c60e0ad9ca41e#rd
```
